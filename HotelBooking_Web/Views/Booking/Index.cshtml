@model HotelBooking_Web.Models.DatPhongViewModel
@{
    ViewBag.Title = "Booking";
    Layout = "~/Views/Shared/_Layout.cshtml";
}

<form id="form-act">
    <div class="booking-page" style="display:flex; gap:24px; margin-top:30px; flex-wrap:wrap;">

        <!-- LEFT FORM -->
        <div class="booking-left" style="flex:1; min-width:360px;">

            <!-- Liên hệ đặt chỗ -->
            <div class="booking-box">
                <h2 class="booking-title">Liên hệ đặt chỗ</h2>

                <div class="form-group">
                    <label>Họ tên *</label>
                    <input type="text" class="input" name="txt_HoTen" placeholder="Như trên CMND" value="@Session["DisplayName"]" required />
                </div>

                <div class="form-group">
                    <label>Điện thoại di động *</label>
                    <div style="display:flex; gap:8px;">
                        <select class="input" style="max-width:110px;">
                            <option>+84</option>
                        </select>
                        <input type="text" class="input" name="txt_SoDienThoai" placeholder="Ví dụ: 0912345678" value="@Session["SoDienThoai"]"  />
                    </div>
                </div>

                <div class="form-group">
                    <label>Email *</label>
                    <input type="email" class="input" name="txt_Email" placeholder="email@example.com" value="@Session["UserEmail"]" required />
                </div>


            </div>


            <!-- Yêu cầu đặc biệt -->
            <div class="booking-box">

                <div class="form-group">
                    <h2 class="booking-title">Ghi chú</h2>
                    <input type="text" class="input" placeholder="Nhập ghi chú ở đây" name="txt_GhiChu" />
                </div>


            </div>

        </div>

        <!-- RIGHT SUMMARY -->
        <div class="booking-right" style="width:360px; min-width:300px;">
            <div class="summary-box">

                <h3 style="font-size:18px; font-weight:700; margin-bottom:8px;">
                    Deluxe Triple With City View (Room Only)
                </h3>

                <div class="muted" style="font-size:14px; margin-bottom:14px;">@Model.SoNguoi người · 1 phòng</div>
                <div class="muted summary-row">
                    <div>Giá mỗi đêm</div>
                    <div>@ViewBag.Phong.GiaMoiDem VND</div>
                </div>

                <div class="summary-section">
                    <div class="summary-row">
                        <div>Nhận phòng</div>
                        <label>@Model.CheckIn</label>
                    </div>
                    <div class="summary-row">
                        <div>Trả phòng</div>
                        <div>@Model.CheckOut</div>
                    </div>

                </div>

                <div class="summary-section">
                    <div class="summary-title">Chi tiết giá</div>
                    <div class="summary-row">
                        <div>Số đêm</div>
                        <div>@Model.SoDem</div>
                    </div>

                    <div class="summary-row">
                        <div>Giá phòng</div>
                        <div>@ViewBag.TongTienPhong VND</div>
                    </div>
                    <div class="summary-row">
                        <div>Thuế & phí</div>
                        <div>@ViewBag.ThuePhi VND</div>
                    </div>

                    <div class="summary-total">
                        <div>Tổng cộng</div>
                        <div class="total-price">@ViewBag.TongTien VND</div>
                    </div>
                </div>
                <input type="hidden" name="txt_TaiKhoanID" value="@Session["TaiKhoanID"]" />
                <input type="hidden" name="txt_PhongID" value="@Model.PhongID" />
                <input type="hidden" name="txt_CheckIn" value="@Model.CheckIn.ToString("yyyy-MM-dd")" />
                <input type="hidden" name="txt_CheckOut" value="@Model.CheckOut.ToString("yyyy-MM-dd")" />
                <input type="hidden" name="txt_SoNguoi" value="@Model.SoNguoi" />
                <input type="hidden" name="txt_TongTien" value="@ViewBag.TongTien" />


                <button type="submit" class="btn btn-primary btn_them" style="width:100%; padding:14px; margin-top:12px; ">
                    Xác Nhận
                </button>


            </div>
        </div>
    </div>
</form>

<script>

    $(document).ready(function () {
        $('#form-act').on('submit', function (e) {
            e.preventDefault();

            var form = $('#form-act')[0];
            var formData = new FormData(form);


            $.ajax({
                type: "POST",
                data: formData,
                contentType: "application/json; charset=utf-8",
                url: window.location.origin + '/Booking/DatPhong',
                processData: false,
                contentType: false,
                cache: false,
                success: function (rs) {
                    console.log(rs);
                    
                    if (rs.ErrCode == 1) {

                        window.location.href = window.location.origin + '/TaiKhoan/BookingList';
                        alert(rs.ErrDesc);
                    }
                    else {

                        alert(rs.ErrDesc);
                    }


                },
                error: function (data) {
                    console.log(data);
                }

            });
        });
    });
</script>

